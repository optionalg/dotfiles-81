#!/bin/sh
#
# wildefyr - 2016 (c) CC
# a fairly nice info script

getSystem() {
    type crux 2>&1 > /dev/null && {
        SYS="$(crux)"
        PACK="$(pkginfo -i | wc -l)"
    }

    type hostnamectl 2>&1 > /dev/null && {
        OS=$(hostnamectl | grep "Operating System:")

        printf '%s\n' "$OS" | grep -q "Debian\|Ubuntu" && {
            SYS="DEBIAN version $(cat /etc/debian_version)"
            PACK=$(dpkg-query -f '${binary:Package}\n' -W | wc -l)
        }
    }
}

f0='[30m'; f1='[31m'; f2='[32m'; f3='[33m'
f4='[34m'; f5='[35m'; f6='[36m'; f7='[37m'
b0='[40m'; b1='[41m'; b2='[42m'; b4='[44m'
b4='[44m'; b5='[45m'; b6='[46m'; b7='[47m'
B='[1m'; R='[0m'; I='[7m'

USER="$USER"
HOST="$(hostname)"

getSystem

KERN="$(uname -sr)"
TIME="$(uptime -p | sed s:"up "::)"

ps ux | grep -v grep | grep "mpv" -q && {
    M="$(mpvc -f '%artist% - %title%')"
}

clear=$(tput sgr0)
clear

cat << EOF
$(wild)
$R
$f7$B$I$b6â–ˆ$I$b0 $USER@$HOST $I$b7 $R
$f7$B$I$b6â–ˆ$I$b0 $KERN - $TIME $R
$f7$B$I$b6â–ˆ$I$b0 $SYS - $PACK Packages $R
EOF

test ! -z "$M" && printf '%s\n' "$f7$B$I$b6â–ˆ$I$b0 $M $R"

printf '\n'
