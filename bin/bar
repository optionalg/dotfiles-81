#!/bin/sh
#
# wildefyr - 2016 (c) wtfpl
# my bar

backbar() {
    barx=$1
    bary=$2
    barw=$3
    barh=$4
    bar_bg=$5

    while :; do
        printf '\n'
        sleep 10m
    done | lemonbar -d -g ${barw}x${barh}+${barx}+${bary} -B${bar_bg} -n "backbar"
}

runTaskbar() {
    while :; do
        pgrep eventually 2>&1 > /dev/null && {
            barinfo
            sleep 0.1
        }
    done
}

. fyrerc

# set bar variables and launch backbar
barw=$((minW + 2*BW))
barh=$((24))
barx=$((SW - barw - XGAP - BW))
bary=$((SH - barh))
bar_bg='#D7D7D7'

backbar $barx $bary $barw $barh $bar_bg &
sleep 0.1

barx=$((barx + BW))
bary=$((bary + BW))
barw=$((barw - 2*BW))
barh=$((barh - BW))
bar_bg='#040404'
bar_fg='#D7D7D7'
bar_font=$(awk '/\.font/ {print $3}' < ~/.Xresources)

runTaskbar | lemonbar -d -g ${barw}x${barh}+${barx}+${bary} -B${bar_bg} \
                      -F${bar_fg} -f${bar_font} -n "mainbar" -a 100 | /bin/sh &
