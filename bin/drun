#!/bin/sh
#
# wildefyr - 2016 (c) CC
# launch dmenu filled with program suggestions and geometry set

CACHE="$HOME/.cache/drun"

. fyrerc

for configuration in \
    ~/.zsh/fyre.zsh \
    ~/.zsh/aliases.zsh \
    ~/.zsh/environment.zsh
do
    . $configuration
done

unset configuration

alias | cut -d'=' -f 1 > $CACHE

printf '%s\n' "$EXECPATHS" | while read -r EXECPATH; do
    find "$EXECPATH" -maxdepth 1 -type f -executable | rev | \
        cut -d'/' -f 1 | rev >> $CACHE
    find "$EXECPATH" -maxdepth 1 -type l -executable | rev | \
        cut -d'/' -f 1 | rev >> $CACHE
done

barx=$((XGAP + BW))
bary=$((0))
barw=$((SW - 2*XGAP - 2*BW))
barh=$((20 - BW))

bar_font=$(awk '/\.font/ {print $3}' < ~/.Xresources)

sort -u < $CACHE | dmenu -f -x $barx -y $bary -w $barw -h $barh -l 0 \
-fn $bar_font -nf '#D7D7D7' -sf '#B23450' -nb '#03070B' -sb '#03070B' | \
${SHELL:-"/bin/zsh"}
